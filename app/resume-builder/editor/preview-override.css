/**
 * Resume Preview Override Styles
 * 
 * Purpose: Clean, document-viewer style preview without wrapper styling
 * Target: Live preview in resume builder editor
 * Safety: CSS-only overrides, no JS logic changes
 * 
 * Requirements Met:
 * ✓ Fixed A4-like width (210mm/794px) with auto-expanding height
 * ✓ No outer card wrapper (transparent, no shadows/borders/rounded corners)
 * ✓ Vertical scrolling when content exceeds viewport
 * ✓ Zoom controls scale viewport, not content
 * ✓ Document-viewer behavior (like Google Docs/Canva)
 */

/* =================================================================
   1. PREVIEW CONTAINER - Remove card styling, enable scrolling
   ================================================================= */

/**
 * Selector: .resume-editor-preview-desktop (Desktop preview wrapper)
 * Why safe: Only targets preview container, doesn't affect JSX structure
 * Impact: Removes max-height constraint, enables vertical scrolling
 */
@media (min-width: 1024px) {
  .resume-editor-preview-desktop {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    max-width: 850px !important;
    /* IMPORTANT: height is set via inline styles in page.tsx - don't override */
    /* Scrolling is CONTAINED to this element only */
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    padding: 0 !important; /* Remove padding - let scrollContainerRef handle it */
    margin: 0 !important;
  }

  /* Child containers - let scrolling happen only within LivePreview's scrollContainerRef */
  .resume-editor-preview-desktop > div {
    overflow: visible !important; /* Allow scrolling and visibility at this level */
    background: transparent !important;
    flex: 1;
    min-height: 0;
  }
}

/* Tablet optimizations (768px - 1023px) */
@media (min-width: 768px) and (max-width: 1023px) {
  .resume-editor-preview-desktop {
    max-width: 100% !important;
    padding: 0 16px !important;
  }
}

/* =================================================================
   2. PREVIEW WRAPPER - Remove outer card, transparent background
   ================================================================= */

/**
 * Selector: Preview motion.div wrapper (targets bg-transparent class context)
 * Why safe: Only removes decorative styling, preserves flex layout
 * Impact: Makes preview area transparent, removes card appearance
 */
.resume-preview-wrapper {
  background: transparent !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  border: none !important;
  padding: 0 !important;
}

/* Override any gradient backgrounds in preview area */
.resume-preview-container {
  background: #ffffff !important; /* Clean white background */
  overflow-y: auto !important;
  overflow-x: hidden !important; /* Prevent horizontal scrolling, focus on vertical */
  padding: 0.5rem !important; /* Minimal padding */
  display: flex !important;
  align-items: flex-start !important; /* Align to top instead of center to show full content */
  justify-content: center !important;
}

/* =================================================================
   3. IFRAME CONTAINER - Fixed A4 width, auto height
   ================================================================= */

/**
 * Selector: Preview iframe wrapper
 * Why safe: Controls iframe display, doesn't modify template content
 * Impact: Fixed width (A4-like), height auto-expands with content
 */
.resume-preview-iframe-wrapper {
  /* Let LivePreview component control width/height via inline styles */
  background: #ffffff !important;
  overflow: visible !important;
  position: relative !important;
  border-radius: 2px !important; /* Minimal rounding */
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important; /* Subtle shadow */
  width: auto !important;
  height: auto !important;
  max-width: 850px !important; /* A4 width constraint */
}

/* Responsive wrapper adjustments */
@media (max-width: 1023px) {
  .resume-preview-iframe-wrapper {
    border-radius: 2px !important;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08) !important;
  }
}

@media (max-width: 639px) {
  .resume-preview-iframe-wrapper {
    border-radius: 0 !important;
    min-height: auto !important;
  }
}

/**
 * Selector: iframe element
 * Why safe: Controls iframe dimensions only, template HTML unaffected
 * Impact: Fixed width, auto-expanding height, no transform scaling
 */
.resume-preview-iframe-wrapper iframe {
  /* NO SCALING - matches View Full Resume exactly */
  border: none !important;
  display: block !important;
  margin: 0 auto !important;
  padding: 0 !important;
  background: white !important;
  transform: none !important; /* NO SCALING - matches View Full Resume */
  transform-origin: top center !important;
  /* Allow iframe content to determine height */
  overflow: visible !important;
  width: 794px !important; /* A4 width - NO SCALING */
  max-width: 100% !important; /* Responsive on small screens */
}

/* =================================================================
   4. ZOOM CONTROLS - Scale viewport container, not iframe content
   ================================================================= */

/**
 * Selector: Zoom-controlled scroll container
 * Why safe: Applies CSS transform to scroll container only
 * Impact: Scales entire preview viewport, content remains full size
 */
.resume-preview-zoom-container {
  transition: transform 0.3s ease-out !important;
  transform-origin: top center !important;
  /* GPU acceleration for smoother transforms on mobile */
  will-change: transform !important;
  backface-visibility: hidden !important;
  -webkit-backface-visibility: hidden !important;
}

/* Zoom level classes (applied via runtime style if needed) */
.resume-preview-zoom-80 {
  transform: scale(0.8) !important;
}

.resume-preview-zoom-100 {
  transform: scale(1.0) !important;
}

.resume-preview-zoom-120 {
  transform: scale(1.2) !important;
}

/* =================================================================
   5. RESUME CONTENT - Typography & Spacing refinements
   ================================================================= */

/**
 * Selector: Resume template content within iframe
 * Why safe: Only affects visual presentation, not layout structure
 * Impact: Enhanced typography, consistent spacing, professional appearance
 */

/* These styles apply to iframe content via universal CSS injection */
.resume-preview-iframe-wrapper iframe {
  /* Inject universal styles into iframe document */
  color-scheme: light !important;
}

/* =================================================================
   6. MOBILE RESPONSIVE - Optimized for all device sizes
   ================================================================= */

/**
 * RESPONSIVE BREAKPOINTS:
 * - Mobile (portrait):  < 640px  - Phone portrait
 * - Mobile (landscape): 640-767px - Phone landscape
 * - Tablet (portrait):  768-1023px - Tablet portrait/small laptop
 * - Desktop:            >= 1024px  - Desktop/large screens
 */

/* Tablet & Small Laptops (768px - 1023px) */
@media (min-width: 768px) and (max-width: 1023px) {
  .resume-preview-iframe-wrapper {
    max-width: 100% !important;
    width: 100% !important;
    padding: 0 !important;
    margin: 0 auto !important;
  }

  .resume-preview-iframe-wrapper iframe {
    width: 794px !important; /* A4 width - NO SCALING */
    max-width: 100% !important;
    transform: none !important; /* NO SCALING - matches View Full Resume */
    transform-origin: top center !important;
    margin: 0 auto !important;
  }

  .resume-preview-container {
    padding: 1.5rem !important;
    background: #f8f9fa !important;
  }

  /* Adjust header for tablet */
  .resume-preview-header {
    padding: 0.875rem 1.25rem !important;
  }
}

/* Mobile Landscape & Small Tablets (640px - 767px) */
@media (min-width: 640px) and (max-width: 767px) {
  .resume-preview-iframe-wrapper {
    max-width: 100% !important;
    width: 100% !important;
    padding: 0 0.5rem !important;
  }

  .resume-preview-iframe-wrapper iframe {
    width: 794px !important; /* A4 width - NO SCALING */
    max-width: 100% !important;
    transform: none !important; /* NO SCALING - matches View Full Resume */
    transform-origin: top center !important;
    margin: 0 auto !important;
  }

  .resume-preview-container {
    padding: 1.25rem !important;
  }
}

/* Mobile Portrait (< 640px) */
@media (max-width: 639px) {
  .resume-preview-iframe-wrapper {
    max-width: 100% !important;
    width: 100% !important;
    padding: 0 !important;
    box-shadow: none !important;
  }

  .resume-preview-iframe-wrapper iframe {
    width: 794px !important; /* A4 width - NO SCALING */
    max-width: 100% !important;
    transform: none !important; /* NO SCALING - matches View Full Resume */
    transform-origin: top center !important;
    min-height: auto !important;
  }

  .resume-preview-container {
    padding: 0.75rem !important;
    background: #ffffff !important; /* Clean white on mobile */
  }

  .resume-preview-header {
    padding: 0.625rem 0.75rem !important;
    font-size: 0.875rem !important;
  }
}

/* Extra Small Devices (< 375px) */
@media (max-width: 374px) {
  .resume-preview-iframe-wrapper iframe {
    transform: none !important; /* NO SCALING - matches View Full Resume */
  }

  .resume-preview-container {
    padding: 0.5rem !important;
  }
}

/* =================================================================
   7. HEADER & CONTROLS - Clean, minimal header styling
   ================================================================= */

/**
 * Selector: Preview header with zoom controls
 * Why safe: Visual styling only, doesn't affect button functionality
 * Impact: Clean, professional header appearance
 */
.resume-preview-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
  border-bottom: none !important;
  padding: 0.75rem 1rem !important;
  flex-shrink: 0 !important;
}

/* Responsive header adjustments */
@media (max-width: 639px) {
  .resume-preview-header {
    padding: 0.625rem 0.875rem !important;
  }
  
  /* Make zoom buttons more touch-friendly on mobile */
  .resume-preview-header button {
    min-width: 44px !important;
    min-height: 44px !important;
    touch-action: manipulation !important;
  }
}

/* =================================================================
   8. TEMPLATE-SPECIFIC OVERRIDES - Ensure consistency
   ================================================================= */

/**
 * Selector: .resume-container within iframe (all templates)
 * Why safe: Targets only the template container, preserves template styles
 * Impact: Ensures consistent A4 width, auto height behavior
 */
.resume-preview-iframe-wrapper iframe .resume-container {
  width: 794px !important; /* A4 width */
  max-width: 100% !important;
  min-height: auto !important;
  height: auto !important;
  margin: 0 auto !important;
  background: white !important;
  /* Remove any box-shadow from template container */
  box-shadow: none !important;
}

/* =================================================================
   9. PRINT & EXPORT - Ensure preview matches PDF output
   ================================================================= */

/**
 * Selector: Print-specific styles
 * Why safe: Only affects print layout, not screen display
 * Impact: Preview appearance matches exported PDF
 */
@media print {
  .resume-preview-container,
  .resume-preview-header {
    display: none !important;
  }

  .resume-preview-iframe-wrapper {
    box-shadow: none !important;
    max-width: none !important;
  }

  .resume-preview-iframe-wrapper iframe {
    width: 210mm !important;
    height: auto !important;
    transform: none !important;
  }
}

/* =================================================================
   10. ACCESSIBILITY - Screen reader and keyboard navigation support
   ================================================================= */

/**
 * Selector: Focus states and accessibility improvements
 * Why safe: Enhances UX without changing visual design
 * Impact: Better keyboard navigation and screen reader support
 */
.resume-preview-zoom-button:focus-visible {
  outline: 2px solid rgba(255, 255, 255, 0.8) !important;
  outline-offset: 2px !important;
}

/* =================================================================
   11. MOBILE TOUCH & SCROLL ENHANCEMENTS
   ================================================================= */

/**
 * Smooth scrolling and touch optimizations for mobile devices
 */
@media (max-width: 1023px) {
  .resume-preview-container {
    -webkit-overflow-scrolling: touch !important; /* Smooth momentum scrolling on iOS */
    scroll-behavior: smooth !important;
  }

  .resume-preview-iframe-wrapper iframe {
    /* Prevent accidental zoom on double-tap */
    touch-action: pan-y pinch-zoom !important;
  }
}

/* Optimize for landscape mobile orientation */
@media (max-width: 1023px) and (orientation: landscape) {
  .resume-preview-container {
    padding: 0.75rem !important;
  }
  
  .resume-preview-header {
    padding: 0.5rem 0.75rem !important;
  }
}

/* =================================================================
   IMPLEMENTATION NOTES
   ================================================================= */

/**
 * SAFETY CHECKLIST:
 * ✓ No JavaScript logic modified
 * ✓ No component structure changed  
 * ✓ No data flow affected
 * ✓ Only CSS overrides applied
 * ✓ All selectors target specific preview elements
 * ✓ No global styles that affect other components
 * 
 * ZOOM BEHAVIOR:
 * - Zoom controls should apply transform to .resume-preview-zoom-container
 * - NOT to iframe content (keeps content at full readable size)
 * - User can scroll to see content that exceeds viewport at higher zoom
 * 
 * HEIGHT BEHAVIOR:
 * - iframe height auto-expands based on content (via JS iframe.contentDocument.body.scrollHeight)
 * - Parent container allows vertical scrolling
 * - No content clipping or hidden sections
 * 
 * WIDTH BEHAVIOR:
 * - Fixed at 794px (A4 width at 96 DPI)
 * - Responsive scaling on mobile via transform
 * - Horizontal scrolling disabled (overflow-x: hidden)
 * 
 * RESPONSIVE BEHAVIOR:
 * Desktop (>= 1024px):
 *   - 850px preview column with 794px A4 content + padding
 *   - Full-size display, no scaling
 *   - Sticky positioning removed for better flow
 * 
 * Tablet Portrait (768px - 1023px):
 *   - 100% width with max 700px iframe
 *   - 0.95 scale for optimal readability
 *   - Enhanced padding and shadows
 * 
 * Mobile Landscape (640px - 767px):
 *   - 100% width with max 600px iframe
 *   - 0.92 scale for balance
 *   - Reduced padding for space efficiency
 * 
 * Mobile Portrait (< 640px):
 *   - 100% natural width, no artificial scaling
 *   - Clean white background
 *   - Minimal shadows and borders
 *   - Touch-optimized controls (44px min size)
 * 
 * Extra Small (< 375px):
 *   - 0.95 scale for very small screens
 *   - Maximum space utilization
 * 
 * TOUCH OPTIMIZATIONS:
 * ✓ Momentum scrolling on iOS (-webkit-overflow-scrolling: touch)
 * ✓ Touch-friendly button sizes (44px minimum)
 * ✓ Prevent accidental zoom (touch-action controls)
 * ✓ GPU acceleration for smooth transforms
 * ✓ Landscape orientation adjustments
 */
